open import lib

concat-map-singleton : âˆ€ {A : Set}(l : ğ•ƒ A) â†’ concat (map [_] l ) â‰¡ l
concat-map-singleton [] = refl
concat-map-singleton (x :: l) rewrite concat-map-singleton l = refl

length-filter' : âˆ€ {A  : Set} (l : ğ•ƒ  A) (p  :  A â†’ ğ”¹) â†’ length (filter p l) â‰¤ length l â‰¡ tt
length-filter' [] p = refl
length-filter' (x :: l) p with p x
length-filter' (x :: l) p | tt = length-filter' l p
length-filter' (x :: l) p | ff = {!!}

filter-idempotent : âˆ€ {A : Set} (l : ğ•ƒ A) (p : A â†’ ğ”¹ ) â†’ filter p (filter p l ) â‰¡ filter p l
filter-idempotent [] p = refl
filter-idempotent (x :: l ) p with keep ( p x )
filter-idempotent (x :: l) p | tt , q rewrite q | q | filter-idempotent l p  = refl
filter-idempotent (x :: l) p | ff , q rewrite q = filter-idempotent l p

div2 : â„•  â†’  â„•
div2 zero = zero
div2 ( suc zero ) = zero
div2 ( suc  (suc x) ) = suc (div2 x)

2*div2 : âˆ€ x â†’ is-even x â‰¡ tt â†’ 2 * div2 x â‰¡ x
2*div2 zero p = refl
2*div2 ( suc (zero ) ) ()
2*div2 ( suc (suc x) )  p rewrite (+suc ( div2 x ) ( div2 x + zero ) ) = {!!}

example-vector : ğ• â„• 4
example-vector = (1 :: 2 :: 3 :: 10 :: []) 
